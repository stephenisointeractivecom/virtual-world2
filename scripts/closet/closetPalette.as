package scripts.closet{	import com.smartfoxserver.v2.entities.data.ISFSObject;	import com.smartfoxserver.v2.entities.data.SFSObject;	import com.smartfoxserver.v2.requests.ExtensionRequest;	import flash.display.*;	import flash.events.*;	import flash.display.MovieClip;	import flash.display.Stage;	import flash.geom.ColorTransform;	import fl.motion.Color;	import flash.display.BitmapData;	//	public class closetPalette extends MovieClip {		public var pNum:int = 0;		private var pActive:Boolean = false;		private var pPalletteBMD:BitmapData = null;		private var pShirtSwatch:Object = null;		private var pPantsSwatch:Object = null;		private var pShoeSwatch:Object = null;		private var pTarget:String = "shirt";		private var pSwatchTarget:Object = null;		private var clr:uint;		//		public function closetPalette():void {			pShirtSwatch = this.parent.shirtSwatch;			pPantsSwatch = this.parent.pantsSwatch;			pShoeSwatch = this.parent.shoeSwatch;			pSwatchTarget = pShirtSwatch;			addEventListener(MouseEvent.MOUSE_DOWN,mousedown);			addEventListener(MouseEvent.MOUSE_UP,mouseup);			this.addEventListener(Event.ENTER_FRAME, enterframe);			pShirtSwatch.addEventListener(MouseEvent.MOUSE_DOWN, selectShirtSwatch);			pPantsSwatch.addEventListener(MouseEvent.MOUSE_DOWN, selectPantsSwatch);			pPantsSwatch.addEventListener(MouseEvent.MOUSE_DOWN, selectPantsSwatch);			pShoeSwatch.addEventListener(MouseEvent.MOUSE_DOWN, selectShoeSwatch);			pPalletteBMD = new BitmapData(this.width,this.height,false);			pPalletteBMD.draw(this);			stop();		}		//		private function mousedown(evt:MouseEvent):void {			pActive = true;		}		//		private function mouseup(evt:MouseEvent):void {			var hex:String = ("0x" + (clr.toString(16).toUpperCase()));			trace(pTarget + ' hex is ' + hex);			var obj:ISFSObject = new SFSObject();			switch(pTarget) {				case 'shirt':					obj.putUtfString("cmd2", "UpdateTopColor");					obj.putUtfString("TopColor", hex);					break;				case 'pants':					obj.putUtfString("cmd2", "UpdateBottomColor");					obj.putUtfString("BottomColor", hex);					break;				case 'shoe':					obj.putUtfString("cmd2", "UpdateShoeColor");					obj.putUtfString("ShoeColor", hex);					break;			}			parent.parent.parent.pRoot.smartFox.send(new ExtensionRequest("set", obj));			pActive = false;		}		//		private function selectShirtSwatch(evt:MouseEvent):void {			pTarget = "shirt";			pSwatchTarget = pShirtSwatch;		}		//		private function selectPantsSwatch(evt:MouseEvent):void {			trace ("selectPantsSwatch");			pTarget = "pants";			pSwatchTarget = pPantsSwatch;		}		//		private function selectShoeSwatch(evt:MouseEvent):void {			trace ("selectShoeSwatch");			pTarget = "shoe";			pSwatchTarget = pShoeSwatch;		}		//		public function enterframe(e):void {			if (! pActive) {				return;			}			var lx = this.mouseX;			var ly = this.mouseY;			if (lx < 1 || ly < 1 || lx > this.width || lx > this.width) {				pActive = false;				return;			}			clr = pPalletteBMD.getPixel(lx,ly);			if (clr != 0) {				var ct:ColorTransform = pSwatchTarget.transform.colorTransform;				ct.color = clr;				pSwatchTarget.transform.colorTransform = ct;				root.pAvatar.changeAvatarTintB (pTarget, clr);			}		}		//	}}//